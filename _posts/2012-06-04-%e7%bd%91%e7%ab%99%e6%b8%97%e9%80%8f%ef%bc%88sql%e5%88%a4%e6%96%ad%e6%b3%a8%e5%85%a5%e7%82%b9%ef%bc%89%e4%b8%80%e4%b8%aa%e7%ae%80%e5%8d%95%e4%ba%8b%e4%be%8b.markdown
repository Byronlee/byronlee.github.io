---
layout: post
status: publish
published: true
title: 网站渗透（sql判断注入点）一个简单事例
author: Byronlee
author_login: ginchenorlee
author_email: ginchenorlee@sina.com
excerpt: ! "要用到：啊D注入工具\r\n\r\n要检测一个网站是否存在注入漏洞那当然要先去判断是否存在注入点啦，其实判断很简单，我们可以用and 1=1
  和and 1=2来判断，如果and 1=1返回正常页面，and 1=2返回错误页面，那么有很大的可能此网站存在注入。\r\n\r\n首先我们要先找到一个带参数的页面，如：http://www.zzbzj.cn/news_view.asp?id=308\r\n\r\n我们现在id=308后面输入and
  1=1 图一\r\n<img src=\"http://www.bitscn.com/upimg/allimg/c100605/12KC0A2K0-19195.jpg\"
  alt=\"\" border=\"0\" /> <img src=\"http://www.bitscn.com/upimg/allimg/c100605/12KC0A3220-2I20.jpg\"
  alt=\"\" width=\"700\" border=\"0\" />\r\n\r\n"
wordpress_id: 39
wordpress_url: http://www.ginchenorlee.com/?p=39
date: !binary |-
  MjAxMi0wNi0wNCAxMTo1OTowNiArMDAwMA==
date_gmt: !binary |-
  MjAxMi0wNi0wNCAxMTo1OTowNiArMDAwMA==
categories:
- 信息安全
tags: []
comments: []
---
<p>要用到：啊D注入工具</p>
<p>要检测一个网站是否存在注入漏洞那当然要先去判断是否存在注入点啦，其实判断很简单，我们可以用and 1=1 和and 1=2来判断，如果and 1=1返回正常页面，and 1=2返回错误页面，那么有很大的可能此网站存在注入。</p>
<p>首先我们要先找到一个带参数的页面，如：http://www.zzbzj.cn/news_view.asp?id=308</p>
<p>我们现在id=308后面输入and 1=1 图一<br />
<img src="http://www.bitscn.com/upimg/allimg/c100605/12KC0A2K0-19195.jpg" alt="" border="0" /> <img src="http://www.bitscn.com/upimg/allimg/c100605/12KC0A3220-2I20.jpg" alt="" width="700" border="0" /></p>
<p><a id="more"></a><a id="more-39"></a></p>
<p>要用到：啊D注入工具</p>
<p>要检测一个网站是否存在注入漏洞那当然要先去判断是否存在注入点啦，其实判断很简单，我们可以用and 1=1 和and 1=2来判断，如果and 1=1返回正常页面，and 1=2返回错误页面，那么有很大的可能此网站存在注入。</p>
<p>首先我们要先找到一个带参数的页面，如：http://www.zzbzj.cn/news_view.asp?id=308</p>
<p>我们现在id=308后面输入and 1=1 图一<br />
<img src="http://www.bitscn.com/upimg/allimg/c100605/12KC0A2K0-19195.jpg" alt="" border="0" /> <img src="http://www.bitscn.com/upimg/allimg/c100605/12KC0A3220-2I20.jpg" alt="" width="700" border="0" /><br />
<strong>下载</strong> (146.97 KB)</p>
<p>3 天前 01:42</p>
<p>图一中我们可以看到页面未出现任何错误，也没有弹出对话框等。那么我们再来输入and 1=2看下。图二</p>
<p><img src="http://www.bitscn.com/upimg/allimg/c100605/12KC0A2K0-19195.jpg" alt="" border="0" /> <img src="http://www.bitscn.com/upimg/allimg/c100605/12KC0A5110-325Y.jpg" alt="" width="700" border="0" /><strong>下载</strong> (125.29 KB)<br />
3 天前 01:42</p>
<p>图二中我们在后面输入and 1=2后没有显示正常的文章，而是出现了错误，那么为什么会如此呢？下面我们就用sql语言来说明一下。</p>
<p>比方说我们在查询admin表user字段中id是7的信息，语句为select user from admin where id=7</p>
<p>在sql语句中and的意思是和，select user from admin where id=7 and 1=1 ，当然了这里1必然等于1，除非小学算术没学或严重缺氧的朋友也许会算术等于三，这就说明语句是成立的。</p>
<p>那么select user from admin where id=7 and 1=2 ，这里1当然不等于2，所以语句不成立，所以数据库中也查不不到，必然会提示错误信息，</p>
<p>那么我们为什么在网站中会出现呢？那是因为程序员在编写程序的时候没有添加容错代码所导致的。</p>
<p>在有些朋友测试的时候用工具检测是存在注入点的，那么为什么添加and 1=1也会报错？那么可能是如下情况，这里我们用啊D检测出此网站存在注入点。如图三</p>
<p><img src="http://www.bitscn.com/upimg/allimg/c100605/12KC0A2K0-19195.jpg" alt="" border="0" /> <img src="http://www.bitscn.com/upimg/allimg/c100605/12KC0AJ30-43131.jpg" alt="" width="700" border="0" /><strong>下载</strong> (75.79 KB)<br />
3 天前 01:43</p>
<p>那么我们在此URL后面添加and1=1看一下。如图四</p>
<p><img src="http://www.bitscn.com/upimg/allimg/c100605/12KC0A2K0-19195.jpg" alt="" border="0" /> <img src="http://www.bitscn.com/upimg/allimg/c100605/12KC0A9560-5ba.jpg" alt="" width="700" border="0" /><strong>下载</strong> (118.78 KB)<br />
3 天前 01:43</p>
<p>添加and1=1报错，也许细心的朋友会注意到了，前面我们测试的网站最后id=后面为数字，这里为字母加数字，这也就是所谓的字符型。</p>
<p>字符型参数注入点分析<br />
和刚才一样，我们先来看第二个字符型注入页面里的查询语句，比如是这个select * from 表 where id='ade7'(为什么加引号？看前面吧！)。原来的查询语句是这个样子的，如果我们还按照数字型参数的那种测试漏洞的方法的话，语句就会变成这样：select * from 表 where id='ade7 and 1=1'和<br />
select * from 表 where id='ade7 and 1=2' ，因为程序会自动查询引号里的内容，如果我们按前面这两个语句这样提交的话，程序就会查询id值为ade7 and 1=1和ade7 and 1=2的记录，这样是查不到结果的（你可不要告诉我数据库里正好有两个记录的id就是ade7 and 1=1 和and 1=2）。这里可能有朋友要问了，为什么不是查询id为'ade7,然后and 1='1呢？好，我现在回答你们，就算可以查询id值为'ade7的记录，那这个句子也是错的，1怎么会等于'1呢？对吧？更何况程序是不可能查询'ade7的，更准备的说是数据库中不可能有一个字段的值是'ade7，因为这个字符串少一个引号，如果直接把这个字符串存入数据库的话，程序会报错的！怎么样？明白了吧？现在再说用 ' and '1'='1和' and '1'='2来测试的的原理！同样是这个查询语句：<br />
select * from 表 where id='ade7'，如果我们在网址后面加了' and '1'='1，那这个查询语句就会变成<br />
select * from 表 where id='ade7' and '1'='1'(这里最外面的那一层引号是程序自动加上的)，变成这个样子！这个语句对不对呢？我们分析一下。如果我们提交个语句，那程序就会自动查询id值是ade7的记录！因为这个记录是存在的（不存在的话那就是这个网页有问题了！），然and后面跟的'1'='1'是正确的，所以这个语句是正确的！如果我们把' and '1'='1换成' and '1'='2，那语句就成了select * from 表 where id='ade7' and '1'='2'，只看后面我们就可以知道这个语句对不对了！'1'怎么可能等于'2'呢？是吧？好了，字符型参数的注入点的原理就介绍到这里！</p>
<p>-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</p>
<p>看到上面的解释我想大家已经能够理解为什么会出错了，那么我们按照上述办法在userid=jbkg8603后面输入了' and '1'='1和了' and '1'='2看下</p>
<p><img src="http://www.bitscn.com/upimg/allimg/c100605/12KC0A2K0-19195.jpg" alt="" border="0" /> <img src="http://www.bitscn.com/upimg/allimg/c100605/12KC0B1630-A217.jpg" alt="" width="700" border="0" /><strong>下载</strong> (107.98 KB)<br />
3 天前 01:44</p>
<p><img src="http://www.bitscn.com/upimg/allimg/c100605/12KC0A2K0-19195.jpg" alt="" border="0" /> <img src="http://www.bitscn.com/upimg/allimg/c100605/12KC0B41Z-MP9.jpg" alt="" width="700" border="0" /><strong>下载</strong> (100.8 KB)<br />
3 天前 01:44</p>
<p>' and '1'='1返回了正常页面，而' and '1'='2返回了错误页面说明存在注入点。</p>
<p>同样，就算后面为汉字类型的也同样用' and '1'='1与' and '1'='2来判断，因为汉字同样属于字符型。如图：</p>
<p><img src="http://www.bitscn.com/upimg/allimg/c100605/12KC0A2K0-19195.jpg" alt="" border="0" /> <img src="http://www.bitscn.com/upimg/allimg/c100605/12KC0BE20-Q929.jpg" alt="" width="700" border="0" /><strong>下载</strong> (179.69 KB)<br />
3 天前 01:45</p>
<p><img src="http://www.bitscn.com/upimg/allimg/c100605/12KC0A2K0-19195.jpg" alt="" border="0" /> <img src="http://www.bitscn.com/upimg/allimg/c100605/12KC0C3240-a227.jpg" alt="" width="700" border="0" /><strong>下载</strong> (177.15 KB)<br />
3 天前 01:45</p>
<p>好了，判断注入点就讲到这里了</p>
