<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Android中在地图上显示两点间路径的方法</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">Byronlee</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Android中在地图上显示两点间路径的方法</h2>
<p class="meta">24 May 2012</p>

<div class="post">
<p><img src="http://www.ligotop.com/uploadfile/2011/0329/20110329013013395.png" alt="" border="0" /></p>

<div><strong>                    代码介绍:</strong><br />
在Android 0.9 以及之前的SDK中，一直有一个com.google.googlenav的package，可以用来实现很多和Google地图相关的复杂功能，比如我今天要讲的显式两点间路径等。但是从1.0的SDK开始这个package被移除了，这使得很多早期的Android程序无法编译和运行，相关的功能也就没法实现了——Google一早就承诺会把Android开源，在开源的前夕移除一些比较高级的API也是可以理解的，何况他提供了很棒的Intent机制让我们调用内置的Google Maps。我在Compare Everywhere的作者Jeffrey Sharkey的blog上看到了相关的一篇文章，学到了一个方法。<br />
首先我们需要知道一点，即在PC浏览器中输入类似http://maps.google.com/maps?f=d&amp;saddr=shanghai&amp;daddr=hangzhou&amp;hl=en</p>
<p>这样的URL就可以在浏览器中得到一个从上海到杭州的路径，其中，saddr表示起点位置，daddr则表示目的地位置，当然也可以使用如X,Y的经纬度来表示。</p>
<p>知道了这一点以后，我们就可以利用Intent新建一个Activity来帮助我们。Android会自动找到并启动合适的应用程序，如果有多个可以打开这个URL的应用程序，它就会让用户选择。我写了一个很简单的Sample，主要的几句代码如下：</p>
<div>
<div id="highlighter_723798">
<pre class="brush: actionscript3; gutter: true">String uri = &quot;http://maps.google.com/maps?f=d&amp;saddr=&quot; + strFrom                     + &quot;,&amp;daddr=&quot; + strTo + &quot;&amp;hl=en&quot;; Log.i(&quot;RouteSam                  ple&quot;, &quot;uri=&quot; + uri);   startActivity(newIntent(I                  ntent.ACTION_VIEW, Uri.parse(uri)));</pre>
</div>

<p></div>
<p>在用户输入完起点和目的地，并确认以后，Android弹出对话框让用户选择合适的应用程序。</p>
<p><img src="http://www.ligotop.com/uploadfile/2011/0329/20110329012824564.jpg" alt="" />我们选择Maps以后，上海到杭州的路径就显式在地图上了。<br />
<img src="http://www.ligotop.com/uploadfile/2011/0329/20110329012825493.jpg" alt="" /></p>
<p>在这个例子中，我们利用了Android的Intent来启动了一个新的Activity，并显式了我们所需要的两点间的路径。由于我们是利用了Google Maps的功能，所以功能上没有多少东西可以定制。当然我觉得这个例子最主要的一点是展示了Android的Intent的灵活用法（官方的Intents List中被没有提及这个用法）。<br />
附上代码：</p>
<p>&nbsp;</p>
<pre class="brush: java; gutter: true">//mapactivity</p>

<p>package com.byronlee;</p>

<p>import android.app.Activity;
import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;</p>

<p>public class MapActivity extends Activity {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.main);
Button button = (Button) findViewById(R.id.buttonOk);
button.setOnClickListener(onClickListener);</p>

<p>}</p>

<p>/** OnClickListener **/
final private OnClickListener onClickListener = new OnClickListener() {</p>

<p>public void onClick(View arg0) {
EditText editFrom = (EditText) findViewById(R.id.editFrom);
String strFrom = editFrom.getText().toString();</p>

<p>EditText editTo = (EditText) findViewById(R.id.editTo);
String strTo = editTo.getText().toString();</p>

<p>//String uri = &quot;http://maps.google.com/maps?f=d&amp;saddr=&quot; + strFrom
// + &quot;,&amp;daddr=&quot; + strTo + &quot;&amp;hl=en&quot;;</p>

<p>String uri =&quot;http://www.wowoyuan.com&quot;;
Log.i(&quot;RouteSample&quot;, &quot;uri=&quot; + uri);</p>

<p>startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(uri)));
}</p>

<p>};
}</p>

<p>//main.xml</p>

<p>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
android:orientation=&quot;horizontal&quot; android:layout<em>width=&quot;fill</em>parent&quot;
android:layout<em>height=&quot;wrap</em>content&quot;&gt;</p>

<p>&lt;TextView android:id=&quot;@+id/textFrom&quot; android:layout<em>width=&quot;wrap</em>content&quot;
android:layout<em>height=&quot;wrap</em>content&quot; android:text=&quot;From&quot; /&gt;</p>

<p>&lt;EditText android:id=&quot;@+id/editFrom&quot; android:layout<em>width=&quot;fill</em>parent&quot;
android:layout<em>height=&quot;wrap</em>content&quot; android:layout_below=&quot;@id/textFrom&quot; /&gt;</p>

<p>&lt;TextView android:id=&quot;@+id/textTo&quot; android:layout<em>width=&quot;wrap</em>content&quot;
android:layout<em>height=&quot;wrap</em>content&quot; android:layout_below=&quot;@+id/editFrom&quot;
android:text=&quot;To&quot; /&gt;</p>

<p>&lt;EditText android:id=&quot;@+id/editTo&quot; android:layout<em>width=&quot;fill</em>parent&quot;
android:layout<em>height=&quot;wrap</em>content&quot; android:layout_below=&quot;@+id/textTo&quot; /&gt;</p>

<p>&lt;Button android:id=&quot;@+id/buttonOk&quot; android:layout<em>width=&quot;wrap</em>content&quot;
android:layout<em>height=&quot;wrap</em>content&quot; android:layout_below=&quot;@+id/editTo&quot;
android:text=&quot;Show the map!&quot; /&gt;</p>

<p>&lt;/RelativeLayout&gt;</pre>
<p>&nbsp;</p>
</div></p>

</div>


          <div class="footer">
            <div class="contact">
              <p>
                Your Name<br />
                What You Are<br />
                you@example.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/yourusername">github.com/yourusername</a><br />
                <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
